

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; gpu_tracker 4.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=42d1b3bd"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="User Guide" href="guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            gpu_tracker
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cli">CLI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gpu_tracker</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<span id="tutorial-label"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h1>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">gpu_tracker</span></code> package provides the <code class="docutils literal notranslate"><span class="pre">Tracker</span></code> class which uses a
subprocess to measure computational resource usage, namely the compute
time, maximum CPU utilization, mean CPU utilization, maximum RAM used,
maximum GPU utilization, mean GPU utilization, and maximum GPU RAM used.
The <code class="docutils literal notranslate"><span class="pre">start()</span></code> method starts this process which tracks usage in the
background. After calling <code class="docutils literal notranslate"><span class="pre">start()</span></code>, one can write the code for which
resource usage is measured, followed by calling the <code class="docutils literal notranslate"><span class="pre">stop()</span></code> method.
The compute time will be the time from the call to <code class="docutils literal notranslate"><span class="pre">start()</span></code> to the
call to <code class="docutils literal notranslate"><span class="pre">stop()</span></code> and the RAM, GPU RAM, CPU utilization, and GPU
utilization quantities will be the respective computational resources
used by the code that’s in between <code class="docutils literal notranslate"><span class="pre">start()</span></code> and <code class="docutils literal notranslate"><span class="pre">stop()</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gpu_tracker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gput</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">example_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">example_function</span>
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span> <span class="o">=</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">(</span><span class="n">n_expected_cores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">example_function</span><span class="p">()</span>
<span class="n">tracker</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Tracker</span></code> class implements the <code class="docutils literal notranslate"><span class="pre">__str__</span></code> method so it can be
printed as a string with the values and units of each computational
resource formatted.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tracker</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Max RAM:
   Unit: gigabytes
   System capacity: 67.254
   System: 2.001
   Main:
      Total RSS: 0.94
      Private RSS: 0.786
      Shared RSS: 0.165
   Descendants:
      Total RSS: 0.0
      Private RSS: 0.0
      Shared RSS: 0.0
   Combined:
      Total RSS: 0.94
      Private RSS: 0.786
      Shared RSS: 0.165
Max GPU RAM:
   Unit: gigabytes
   System capacity: 16.376
   System: 0.535
   Main: 0.314
   Descendants: 0.0
   Combined: 0.314
CPU utilization:
   System core count: 12
   Number of expected cores: 1
   System:
      Max sum percent: 162.3
      Max hardware percent: 13.525
      Mean sum percent: 144.283
      Mean hardware percent: 12.024
   Main:
      Max sum percent: 101.4
      Max hardware percent: 101.4
      Mean sum percent: 96.7
      Mean hardware percent: 96.7
   Descendants:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
   Combined:
      Max sum percent: 101.4
      Max hardware percent: 101.4
      Mean sum percent: 96.7
      Mean hardware percent: 96.7
   Main number of threads: 15
   Descendants number of threads: 0
   Combined number of threads: 15
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 5.0
      Max hardware percent: 5.0
      Mean sum percent: 0.417
      Mean hardware percent: 0.417
Compute time:
   Unit: hours
   Time: 0.001
</pre></div>
</div>
<p>The output is organized by computational resource followed by
information specific to that resource. The system capacity is a constant
for the total RAM capacity across the entire operating system. There is
a system capacity field both for RAM and GPU RAM. This is not to be
confused with the system field, which measures the maximum RAM / GPU RAM
(operating system wide) that was actually used over the duration of the
computational-resource tracking. Both the RAM and GPU RAM have 3
additional fields, namely the usage of the main process itself followed
by the summed usage of any descendant processes it may have (i.e. child
processes, grandchild processes, etc.), and combined usage which is the
sum of the main and its descendant processes. RAM is divided further to
include the private RSS (RAM usage unique to the process), shared RSS
(RAM that’s shared by a process and at least one other process), and
total RSS (the sum of private and shared RSS). The private and shared
RSS values are only available on Linux distributions. So for non-linux
operating systems, the private and shared RSS will remain 0 and only the
total RSS will be reported. Theoretically, the combined total RSS would
never exceed the overall system RAM usage, but inaccuracies resulting
from shared RSS can cause this to happen, especially for non-linux
operating systems (see note below).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Tracker</span></code> assumes that GPU memory is not shared across multiple
processes and if it is, the reported GPU RAM of “descendant” and
“combined” may be an overestimation.</p>
<p>The CPU utilization includes the system core count field which is the
total number of cores available system-wide. Utilization is measured for
the main process, its descendants, the main process and its descendants
combined, and CPU utilization across the entire system. The sum percent
is the sum of the percentages of all the cores being used. The hardware
percent is that divided by the expected number of cores being used
i.e. the optional <code class="docutils literal notranslate"><span class="pre">n_expected_cores</span></code> parameter (defaults to the number
of cores in the entire system) for the main, descendants, and combined
measurements. For the system measurements, hardware percent is divided
by the total number of cores in the system regardless of the value of
<code class="docutils literal notranslate"><span class="pre">n_expected_cores</span></code>. The max percent is the highest percentage detected
through the duration of tracking while the mean percent is the average
of all the percentages detected over that duration. The CPU utilization
concludes with the maximum number of threads used at any time for the
main process and the sum of the threads used across its descendant
processes and combined.</p>
<p>The GPU utilization is similar to the CPU utilization but rather than
being based on utilization of processes, it can only measure the
utilization percentages of the GPUs themselves, regardless of what
processes are using them. To ameliorate this limitation, the optional
<code class="docutils literal notranslate"><span class="pre">gpu_uuids</span></code> parameter can be set to specify which GPUs to measure
utilization for (defaults to all the GPUs in the system). The system GPU
count is the total number of GPUs in the system. The sum percent is the
sum of all the percentages of these GPUs and the hardware percent is
that divided by the expected number of GPUs being used
(i.e. <code class="docutils literal notranslate"><span class="pre">len(gpu_uuids)</span></code>). Likewise with CPU utilization, the max and
mean of both the sum and hardware percentages are provided.</p>
<p>The compute time is the real time that the computational-resource
tracking lasted (as compared to CPU time).</p>
<p><strong>NOTE</strong> <em>The keywords “descendants” and “combined” in the output above
indicate a sum of the RSS used by multiple processes. It’s important to
keep in mind that on non-linux operating systems, this sum does not take
into account shared memory but rather adds up the total RSS of all
processes, which can lead to an overestimation. For Linux distributions,
however, pieces of shared memory are only counted once.</em></p>
<p>The <code class="docutils literal notranslate"><span class="pre">Tracker</span></code> can alternatively be used as a context manager rather
than explicitly calling <code class="docutils literal notranslate"><span class="pre">start()</span></code> and <code class="docutils literal notranslate"><span class="pre">stop()</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">()</span> <span class="k">as</span> <span class="n">tracker</span><span class="p">:</span>
    <span class="n">example_function</span><span class="p">()</span>
</pre></div>
</div>
<p>The units of the computational resources can be modified as desired. For
example, to measure the RAM in megabytes, the GPU RAM in megabytes, and
the compute time in seconds:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">(</span><span class="n">ram_unit</span><span class="o">=</span><span class="s1">&#39;megabytes&#39;</span><span class="p">,</span> <span class="n">gpu_ram_unit</span><span class="o">=</span><span class="s1">&#39;megabytes&#39;</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;seconds&#39;</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracker</span><span class="p">:</span>
    <span class="n">example_function</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tracker</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Max RAM:
   Unit: megabytes
   System capacity: 67254.17
   System: 2336.362
   Main:
      Total RSS: 919.99
      Private RSS: 699.384
      Shared RSS: 230.269
   Descendants:
      Total RSS: 0.0
      Private RSS: 0.0
      Shared RSS: 0.0
   Combined:
      Total RSS: 919.99
      Private RSS: 699.384
      Shared RSS: 230.269
Max GPU RAM:
   Unit: megabytes
   System capacity: 16376.0
   System: 727.0
   Main: 506.0
   Descendants: 0.0
   Combined: 506.0
CPU utilization:
   System core count: 12
   Number of expected cores: 12
   System:
      Max sum percent: 166.5
      Max hardware percent: 13.875
      Mean sum percent: 144.55
      Mean hardware percent: 12.046
   Main:
      Max sum percent: 104.8
      Max hardware percent: 8.733
      Mean sum percent: 97.458
      Mean hardware percent: 8.122
   Descendants:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
   Combined:
      Max sum percent: 104.8
      Max hardware percent: 8.733
      Mean sum percent: 97.458
      Mean hardware percent: 8.122
   Main number of threads: 15
   Descendants number of threads: 0
   Combined number of threads: 15
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
Compute time:
   Unit: seconds
   Time: 2.685
</pre></div>
</div>
<p>The same information as the text format can be provided as a dictionary
via the <code class="docutils literal notranslate"><span class="pre">to_json()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">Tracker</span></code>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tracker</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
 &quot;max_ram&quot;: {
  &quot;unit&quot;: &quot;megabytes&quot;,
  &quot;system_capacity&quot;: 67254.1696,
  &quot;system&quot;: 2336.3624959999997,
  &quot;main&quot;: {
   &quot;total_rss&quot;: 919.9902719999999,
   &quot;private_rss&quot;: 699.3838079999999,
   &quot;shared_rss&quot;: 230.268928
  },
  &quot;descendants&quot;: {
   &quot;total_rss&quot;: 0.0,
   &quot;private_rss&quot;: 0.0,
   &quot;shared_rss&quot;: 0.0
  },
  &quot;combined&quot;: {
   &quot;total_rss&quot;: 919.9902719999999,
   &quot;private_rss&quot;: 699.3838079999999,
   &quot;shared_rss&quot;: 230.268928
  }
 },
 &quot;max_gpu_ram&quot;: {
  &quot;unit&quot;: &quot;megabytes&quot;,
  &quot;system_capacity&quot;: 16376.0,
  &quot;system&quot;: 727.0,
  &quot;main&quot;: 506.0,
  &quot;descendants&quot;: 0.0,
  &quot;combined&quot;: 506.0
 },
 &quot;cpu_utilization&quot;: {
  &quot;system_core_count&quot;: 12,
  &quot;n_expected_cores&quot;: 12,
  &quot;system&quot;: {
   &quot;max_sum_percent&quot;: 166.5,
   &quot;max_hardware_percent&quot;: 13.875,
   &quot;mean_sum_percent&quot;: 144.55,
   &quot;mean_hardware_percent&quot;: 12.045833333333333
  },
  &quot;main&quot;: {
   &quot;max_sum_percent&quot;: 104.8,
   &quot;max_hardware_percent&quot;: 8.733333333333333,
   &quot;mean_sum_percent&quot;: 97.45833333333333,
   &quot;mean_hardware_percent&quot;: 8.121527777777779
  },
  &quot;descendants&quot;: {
   &quot;max_sum_percent&quot;: 0.0,
   &quot;max_hardware_percent&quot;: 0.0,
   &quot;mean_sum_percent&quot;: 0.0,
   &quot;mean_hardware_percent&quot;: 0.0
  },
  &quot;combined&quot;: {
   &quot;max_sum_percent&quot;: 104.8,
   &quot;max_hardware_percent&quot;: 8.733333333333333,
   &quot;mean_sum_percent&quot;: 97.45833333333333,
   &quot;mean_hardware_percent&quot;: 8.121527777777779
  },
  &quot;main_n_threads&quot;: 15,
  &quot;descendants_n_threads&quot;: 0,
  &quot;combined_n_threads&quot;: 15
 },
 &quot;gpu_utilization&quot;: {
  &quot;system_gpu_count&quot;: 1,
  &quot;n_expected_gpus&quot;: 1,
  &quot;gpu_percentages&quot;: {
   &quot;max_sum_percent&quot;: 0.0,
   &quot;max_hardware_percent&quot;: 0.0,
   &quot;mean_sum_percent&quot;: 0.0,
   &quot;mean_hardware_percent&quot;: 0.0
  }
 },
 &quot;compute_time&quot;: {
  &quot;unit&quot;: &quot;seconds&quot;,
  &quot;time&quot;: 2.684972047805786
 }
}
</pre></div>
</div>
<p>Using Python data classes, the <code class="docutils literal notranslate"><span class="pre">Tracker</span></code> class additionally has a
<code class="docutils literal notranslate"><span class="pre">resource_usage</span></code> attribute containing fields that provide the usage
information for each individual computational resource.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_ram</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MaxRAM(unit=&#39;megabytes&#39;, system_capacity=67254.1696, system=2336.3624959999997, main=RSSValues(total_rss=919.9902719999999, private_rss=699.3838079999999, shared_rss=230.268928), descendants=RSSValues(total_rss=0.0, private_rss=0.0, shared_rss=0.0), combined=RSSValues(total_rss=919.9902719999999, private_rss=699.3838079999999, shared_rss=230.268928))
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_ram</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;megabytes&#39;
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_ram</span><span class="o">.</span><span class="n">main</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RSSValues(total_rss=919.9902719999999, private_rss=699.3838079999999, shared_rss=230.268928)
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_ram</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">total_rss</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>919.9902719999999
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_gpu_ram</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MaxGPURAM(unit=&#39;megabytes&#39;, system_capacity=16376.0, system=727.0, main=506.0, descendants=0.0, combined=506.0)
</pre></div>
</div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">compute_time</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ComputeTime(unit=&#39;seconds&#39;, time=2.684972047805786)
</pre></div>
</div>
<p>Sometimes the code can fail. In order to collect the resource usage up
to the point of failure, use a try/except block like so:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">()</span> <span class="k">as</span> <span class="n">tracker</span><span class="p">:</span>
        <span class="n">example_function</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;AN ERROR&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The following error occured while tracking: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tracker</span><span class="o">.</span><span class="n">resource_usage</span><span class="o">.</span><span class="n">max_gpu_ram</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The following error occured while tracking: AN ERROR
0.506
</pre></div>
</div>
<p>If you do not catch the error in your code or if tracking otherwise is
interrupted (e.g. you are debugging your code and you stop partway), the
<code class="docutils literal notranslate"><span class="pre">resource_usage</span></code> attribute will not be set and that information will
not be able to be obtained in memory. In such a case, the
<code class="docutils literal notranslate"><span class="pre">resource_usage</span></code> attribute will be stored in a hidden pickle file in
the working directory with a randomly generated name. Its file path can
be optionally overriden with the <code class="docutils literal notranslate"><span class="pre">resource_usage_file</span></code> parameter.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">tracker</span> <span class="o">=</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">(</span><span class="n">resource_usage_file</span><span class="o">=</span><span class="s1">&#39;path/to/my-file.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is an example of using a child process. Notice the descendants
fields are now non-zero.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spawn&#39;</span><span class="p">)</span>
<span class="n">child_process</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">example_function</span><span class="p">)</span>
<span class="k">with</span> <span class="n">gput</span><span class="o">.</span><span class="n">Tracker</span><span class="p">(</span><span class="n">n_expected_cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="k">as</span> <span class="n">tracker</span><span class="p">:</span>
    <span class="n">child_process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">example_function</span><span class="p">()</span>
    <span class="n">child_process</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="n">child_process</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tracker</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Max RAM:
   Unit: gigabytes
   System capacity: 67.254
   System: 3.033
   Main:
      Total RSS: 0.865
      Private RSS: 0.55
      Shared RSS: 0.32
   Descendants:
      Total RSS: 0.854
      Private RSS: 0.737
      Shared RSS: 0.118
   Combined:
      Total RSS: 1.437
      Private RSS: 1.125
      Shared RSS: 0.32
Max GPU RAM:
   Unit: gigabytes
   System capacity: 16.376
   System: 1.235
   Main: 0.506
   Descendants: 0.506
   Combined: 1.012
CPU utilization:
   System core count: 12
   Number of expected cores: 2
   System:
      Max sum percent: 456.5
      Max hardware percent: 38.042
      Mean sum percent: 216.675
      Mean hardware percent: 18.056
   Main:
      Max sum percent: 102.6
      Max hardware percent: 51.3
      Mean sum percent: 66.65
      Mean hardware percent: 33.325
   Descendants:
      Max sum percent: 175.8
      Max hardware percent: 87.9
      Mean sum percent: 105.392
      Mean hardware percent: 52.696
   Combined:
      Max sum percent: 278.4
      Max hardware percent: 139.2
      Mean sum percent: 172.042
      Mean hardware percent: 86.021
   Main number of threads: 15
   Descendants number of threads: 13
   Combined number of threads: 28
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 8.0
      Max hardware percent: 8.0
      Mean sum percent: 1.333
      Mean hardware percent: 1.333
Compute time:
   Unit: hours
   Time: 0.001
</pre></div>
</div>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">gpu-tracker</span></code> package also comes with a commandline interface that
can track the computational-resource-usage of any shell command, not
just Python code. Entering <code class="docutils literal notranslate"><span class="pre">gpu-tracker</span> <span class="pre">-h</span></code> in a shell will show the
help message.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -h
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Tracks the computational resource usage (RAM, GPU RAM, CPU utilization, GPU utilization, and compute time) of a process corresponding to a given shell command.

Usage:
    gpu-tracker -h | --help
    gpu-tracker -v | --version
    gpu-tracker --execute=&lt;command&gt; [--output=&lt;output&gt;] [--format=&lt;format&gt;] [--st=&lt;sleep-time&gt;] [--ru=&lt;ram-unit&gt;] [--gru=&lt;gpu-ram-unit&gt;] [--tu=&lt;time-unit&gt;] [--nec=&lt;num-cores&gt;] [--guuids=&lt;gpu-uuids&gt;] [--disable-logs]

Options:
    -h --help               Show this help message and exit.
    -v --version            Show package version and exit.
    -e --execute=&lt;command&gt;  The command to run along with its arguments all within quotes e.g. &quot;ls -l -a&quot;.
    -o --output=&lt;output&gt;    File path to store the computational-resource-usage measurements. If not set, prints measurements to the screen.
    -f --format=&lt;format&gt;    File format of the output. Either &#39;json&#39; or &#39;text&#39;. Defaults to &#39;text&#39;.
    --st=&lt;sleep-time&gt;       The number of seconds to sleep in between usage-collection iterations.
    --ru=&lt;ram-unit&gt;         One of &#39;bytes&#39;, &#39;kilobytes&#39;, &#39;megabytes&#39;, &#39;gigabytes&#39;, or &#39;terabytes&#39;.
    --gru=&lt;gpu-ram-unit&gt;    One of &#39;bytes&#39;, &#39;kilobytes&#39;, &#39;megabytes&#39;, &#39;gigabytes&#39;, or &#39;terabytes&#39;.
    --tu=&lt;time-unit&gt;        One of &#39;seconds&#39;, &#39;minutes&#39;, &#39;hours&#39;, or &#39;days&#39;.
    --nec=&lt;num-cores&gt;       The number of cores expected to be used. Defaults to the number of cores in the entire operating system.
    --guuids=&lt;gpu-uuids&gt;    Comma separated list of the UUIDs of the GPUs for which to track utilization e.g. gpu-uuid1,gpu-uuid2,etc. Defaults to all the GPUs in the system.
    --disable-logs          If set, warnings are suppressed during tracking. Otherwise, the Tracker logs warnings as usual.
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-e</span></code> or <code class="docutils literal notranslate"><span class="pre">--execute</span></code> is a required option where the desired shell
command is provided, with both the command and its proceeding arguments
surrounded by quotes. Below is an example of running the <code class="docutils literal notranslate"><span class="pre">bash</span></code>
command with an argument of <code class="docutils literal notranslate"><span class="pre">example-script.sh</span></code>. When the command
completes, its status code is reported.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -e &quot;bash example-script.sh&quot; --st=0.3
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Resource tracking complete. Process completed with status code: 0
Max RAM:
   Unit: gigabytes
   System capacity: 67.254
   System: 2.896
   Main:
      Total RSS: 0.003
      Private RSS: 0.0
      Shared RSS: 0.003
   Descendants:
      Total RSS: 0.877
      Private RSS: 0.759
      Shared RSS: 0.118
   Combined:
      Total RSS: 0.878
      Private RSS: 0.759
      Shared RSS: 0.119
Max GPU RAM:
   Unit: gigabytes
   System capacity: 16.376
   System: 1.043
   Main: 0.0
   Descendants: 0.314
   Combined: 0.314
CPU utilization:
   System core count: 12
   Number of expected cores: 12
   System:
      Max sum percent: 324.1
      Max hardware percent: 27.008
      Mean sum percent: 164.91
      Mean hardware percent: 13.743
   Main:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
   Descendants:
      Max sum percent: 361.4
      Max hardware percent: 30.117
      Mean sum percent: 123.42
      Mean hardware percent: 10.285
   Combined:
      Max sum percent: 361.4
      Max hardware percent: 30.117
      Mean sum percent: 123.42
      Mean hardware percent: 10.285
   Main number of threads: 1
   Descendants number of threads: 12
   Combined number of threads: 13
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
Compute time:
   Unit: hours
   Time: 0.001
</pre></div>
</div>
<p><em>Notice that the RAM and GPU RAM usage primarily takes place in the
descendant processes since the bash command itself calls the commands
relevant to resource usage.</em></p>
<p>The units of the computational resources can be modified. For example,
–tu stands for time-unit, –gru stands for gpu-ram-unit, and –ru stands
for ram-unit.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -e &#39;bash example-script.sh&#39; --tu=seconds --gru=megabytes --ru=megabytes --st=0.2
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Resource tracking complete. Process completed with status code: 0
Max RAM:
   Unit: megabytes
   System capacity: 67254.17
   System: 2420.457
   Main:
      Total RSS: 3.109
      Private RSS: 0.319
      Shared RSS: 2.789
   Descendants:
      Total RSS: 849.125
      Private RSS: 731.435
      Shared RSS: 118.125
   Combined:
      Total RSS: 850.338
      Private RSS: 731.754
      Shared RSS: 119.017
Max GPU RAM:
   Unit: megabytes
   System capacity: 16376.0
   System: 1235.0
   Main: 0.0
   Descendants: 506.0
   Combined: 506.0
CPU utilization:
   System core count: 12
   Number of expected cores: 12
   System:
      Max sum percent: 316.4
      Max hardware percent: 26.367
      Mean sum percent: 168.077
      Mean hardware percent: 14.006
   Main:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
   Descendants:
      Max sum percent: 517.3
      Max hardware percent: 43.108
      Mean sum percent: 130.623
      Mean hardware percent: 10.885
   Combined:
      Max sum percent: 517.3
      Max hardware percent: 43.108
      Mean sum percent: 130.623
      Mean hardware percent: 10.885
   Main number of threads: 1
   Descendants number of threads: 12
   Combined number of threads: 13
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 5.0
      Max hardware percent: 5.0
      Mean sum percent: 0.462
      Mean hardware percent: 0.462
Compute time:
   Unit: seconds
   Time: 3.995
</pre></div>
</div>
<p>By default, the computational-resource-usage statistics are printed to
the screen. The <code class="docutils literal notranslate"><span class="pre">-o</span></code> or <code class="docutils literal notranslate"><span class="pre">--output</span></code> option can be specified to store
that same content in a file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -e &#39;bash example-script.sh&#39; -o out.txt --st=0.2
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Resource tracking complete. Process completed with status code: 0
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat out.txt
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Max RAM:
   Unit: gigabytes
   System capacity: 67.254
   System: 2.43
   Main:
      Total RSS: 0.003
      Private RSS: 0.0
      Shared RSS: 0.003
   Descendants:
      Total RSS: 0.884
      Private RSS: 0.766
      Shared RSS: 0.118
   Combined:
      Total RSS: 0.885
      Private RSS: 0.766
      Shared RSS: 0.119
Max GPU RAM:
   Unit: gigabytes
   System capacity: 16.376
   System: 1.043
   Main: 0.0
   Descendants: 0.314
   Combined: 0.314
CPU utilization:
   System core count: 12
   Number of expected cores: 12
   System:
      Max sum percent: 405.0
      Max hardware percent: 33.75
      Mean sum percent: 165.357
      Mean hardware percent: 13.78
   Main:
      Max sum percent: 0.0
      Max hardware percent: 0.0
      Mean sum percent: 0.0
      Mean hardware percent: 0.0
   Descendants:
      Max sum percent: 573.7
      Max hardware percent: 47.808
      Mean sum percent: 124.871
      Mean hardware percent: 10.406
   Combined:
      Max sum percent: 573.7
      Max hardware percent: 47.808
      Mean sum percent: 124.871
      Mean hardware percent: 10.406
   Main number of threads: 1
   Descendants number of threads: 12
   Combined number of threads: 13
GPU utilization:
   System GPU count: 1
   Number of expected GPUs: 1
   GPU percentages:
      Max sum percent: 5.0
      Max hardware percent: 5.0
      Mean sum percent: 0.357
      Mean hardware percent: 0.357
Compute time:
   Unit: hours
   Time: 0.001
</pre></div>
</div>
<p>By default, the format of the output is “text”. The <code class="docutils literal notranslate"><span class="pre">-f</span></code> or
<code class="docutils literal notranslate"><span class="pre">--format</span></code> option can specify the format to be “json” instead.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -e &#39;bash example-script.sh&#39; -f json --st=0.2
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Resource tracking complete. Process completed with status code: 0
{
 &quot;max_ram&quot;: {
  &quot;unit&quot;: &quot;gigabytes&quot;,
  &quot;system_capacity&quot;: 67.2541696,
  &quot;system&quot;: 2.5132195840000002,
  &quot;main&quot;: {
   &quot;total_rss&quot;: 0.00311296,
   &quot;private_rss&quot;: 0.000323584,
   &quot;shared_rss&quot;: 0.002789376
  },
  &quot;descendants&quot;: {
   &quot;total_rss&quot;: 0.8446238720000001,
   &quot;private_rss&quot;: 0.7268597760000001,
   &quot;shared_rss&quot;: 0.11776409600000001
  },
  &quot;combined&quot;: {
   &quot;total_rss&quot;: 0.8458403840000001,
   &quot;private_rss&quot;: 0.7271833600000001,
   &quot;shared_rss&quot;: 0.11865702400000001
  }
 },
 &quot;max_gpu_ram&quot;: {
  &quot;unit&quot;: &quot;gigabytes&quot;,
  &quot;system_capacity&quot;: 16.376,
  &quot;system&quot;: 1.235,
  &quot;main&quot;: 0.0,
  &quot;descendants&quot;: 0.506,
  &quot;combined&quot;: 0.506
 },
 &quot;cpu_utilization&quot;: {
  &quot;system_core_count&quot;: 12,
  &quot;n_expected_cores&quot;: 12,
  &quot;system&quot;: {
   &quot;max_sum_percent&quot;: 316.3,
   &quot;max_hardware_percent&quot;: 26.358333333333334,
   &quot;mean_sum_percent&quot;: 167.90769230769232,
   &quot;mean_hardware_percent&quot;: 13.992307692307692
  },
  &quot;main&quot;: {
   &quot;max_sum_percent&quot;: 0.0,
   &quot;max_hardware_percent&quot;: 0.0,
   &quot;mean_sum_percent&quot;: 0.0,
   &quot;mean_hardware_percent&quot;: 0.0
  },
  &quot;descendants&quot;: {
   &quot;max_sum_percent&quot;: 527.1,
   &quot;max_hardware_percent&quot;: 43.925000000000004,
   &quot;mean_sum_percent&quot;: 130.81538461538463,
   &quot;mean_hardware_percent&quot;: 10.90128205128205
  },
  &quot;combined&quot;: {
   &quot;max_sum_percent&quot;: 527.1,
   &quot;max_hardware_percent&quot;: 43.925000000000004,
   &quot;mean_sum_percent&quot;: 130.81538461538463,
   &quot;mean_hardware_percent&quot;: 10.90128205128205
  },
  &quot;main_n_threads&quot;: 1,
  &quot;descendants_n_threads&quot;: 12,
  &quot;combined_n_threads&quot;: 13
 },
 &quot;gpu_utilization&quot;: {
  &quot;system_gpu_count&quot;: 1,
  &quot;n_expected_gpus&quot;: 1,
  &quot;gpu_percentages&quot;: {
   &quot;max_sum_percent&quot;: 5.0,
   &quot;max_hardware_percent&quot;: 5.0,
   &quot;mean_sum_percent&quot;: 0.38461538461538464,
   &quot;mean_hardware_percent&quot;: 0.38461538461538464
  }
 },
 &quot;compute_time&quot;: {
  &quot;unit&quot;: &quot;hours&quot;,
  &quot;time&quot;: 0.0010899075534608628
 }
}
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ gpu-tracker -e &#39;bash example-script.sh&#39; -f json -o out.json --st=0.3
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Resource tracking complete. Process completed with status code: 0
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat out.json
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
 &quot;max_ram&quot;: {
  &quot;unit&quot;: &quot;gigabytes&quot;,
  &quot;system_capacity&quot;: 67.2541696,
  &quot;system&quot;: 2.325712896,
  &quot;main&quot;: {
   &quot;total_rss&quot;: 0.0031088640000000002,
   &quot;private_rss&quot;: 0.00031948800000000004,
   &quot;shared_rss&quot;: 0.002789376
  },
  &quot;descendants&quot;: {
   &quot;total_rss&quot;: 0.822874112,
   &quot;private_rss&quot;: 0.705110016,
   &quot;shared_rss&quot;: 0.11776409600000001
  },
  &quot;combined&quot;: {
   &quot;total_rss&quot;: 0.824086528,
   &quot;private_rss&quot;: 0.705429504,
   &quot;shared_rss&quot;: 0.11865702400000001
  }
 },
 &quot;max_gpu_ram&quot;: {
  &quot;unit&quot;: &quot;gigabytes&quot;,
  &quot;system_capacity&quot;: 16.376,
  &quot;system&quot;: 1.235,
  &quot;main&quot;: 0.0,
  &quot;descendants&quot;: 0.392,
  &quot;combined&quot;: 0.392
 },
 &quot;cpu_utilization&quot;: {
  &quot;system_core_count&quot;: 12,
  &quot;n_expected_cores&quot;: 12,
  &quot;system&quot;: {
   &quot;max_sum_percent&quot;: 332.1,
   &quot;max_hardware_percent&quot;: 27.675,
   &quot;mean_sum_percent&quot;: 166.07,
   &quot;mean_hardware_percent&quot;: 13.839166666666666
  },
  &quot;main&quot;: {
   &quot;max_sum_percent&quot;: 0.0,
   &quot;max_hardware_percent&quot;: 0.0,
   &quot;mean_sum_percent&quot;: 0.0,
   &quot;mean_hardware_percent&quot;: 0.0
  },
  &quot;descendants&quot;: {
   &quot;max_sum_percent&quot;: 104.1,
   &quot;max_hardware_percent&quot;: 8.674999999999999,
   &quot;mean_sum_percent&quot;: 99.77000000000001,
   &quot;mean_hardware_percent&quot;: 8.314166666666665
  },
  &quot;combined&quot;: {
   &quot;max_sum_percent&quot;: 104.1,
   &quot;max_hardware_percent&quot;: 8.674999999999999,
   &quot;mean_sum_percent&quot;: 99.77000000000001,
   &quot;mean_hardware_percent&quot;: 8.314166666666665
  },
  &quot;main_n_threads&quot;: 1,
  &quot;descendants_n_threads&quot;: 12,
  &quot;combined_n_threads&quot;: 13
 },
 &quot;gpu_utilization&quot;: {
  &quot;system_gpu_count&quot;: 1,
  &quot;n_expected_gpus&quot;: 1,
  &quot;gpu_percentages&quot;: {
   &quot;max_sum_percent&quot;: 5.0,
   &quot;max_hardware_percent&quot;: 5.0,
   &quot;mean_sum_percent&quot;: 0.5,
   &quot;mean_hardware_percent&quot;: 0.5
  }
 },
 &quot;compute_time&quot;: {
  &quot;unit&quot;: &quot;hours&quot;,
  &quot;time&quot;: 0.0010636144214206272
 }
}
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="guide.html" class="btn btn-neutral float-left" title="User Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Erik Huckvale, Hunter N. B. Moseley.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>